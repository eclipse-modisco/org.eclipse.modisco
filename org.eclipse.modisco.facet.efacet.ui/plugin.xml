<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?eclipse version="3.4"?>
<!--
    Copyright (c) 2011, 2015 Mia-Software, Soft-Maint.
    All rights reserved. This program and the accompanying materials
    are made available under the terms of the Eclipse Public License v1.0
    which accompanies this distribution, and is available at
    http://www.eclipse.org/legal/epl-v10.html
   
    Contributors:
        Nicolas Guyomar (Mia-Software) - initial API and implementation
        Grégoire Dupé (Mia-Software) - Bug 364325 - [Restructuring] The user must be able to navigate into a model using the Facet.
        Grégoire Dupé (Mia-Software) - Bug 377782 - The command 'Navigation' and 'View in table' must not be unable in all menu.
        Grégoire Dupé (Mia-Software) - Bug 441051 - Reusable customization and facet loading dialogs
        Jonathan Pepin (Soft-Maint) - Bug 463907 - Command for load and save Facet serialization
        Grégoire Dupé (Mia-Software) - Bug 480772 - NPE at org.eclipse.emf.facet.efacet.ui.internal.handlers.LoadFacetHandler.execute(LoadFacetHandler.java:44)
 -->

<plugin>
   <extension-point id="queryFactoryWizardPageRegistration" name="%extension-point.name" schema="schema/queryFactoryWizardPageRegistration.exsd"/>
   <extension-point id="eTypedElementResultDisplay" name="%ETypedElementResult_Display" schema="schema/eTypedElementResultDisplay.exsd"/>
   <extension point="org.eclipse.ui.newWizards">
      <wizard
            category="org.eclipse.emf.facet.common.ui.wizardsCategory"
            class="org.eclipse.modisco.facet.efacet.ui.internal.wizards.CreateFacetSetWizardImpl"
            icon="icons/facet.gif"
            id="org.eclipse.emf.facet.infra.facet.editor.presentation.FacetModelWizardID"
            name="%wizard.name">
         <description>
            %wizard.description
         </description>
         <selection
               class="org.eclipse.core.resources.IResource">
         </selection>
      </wizard>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="true"
            locationURI="popup:org.eclipse.emf.facet.efacet.presentation.EFacetEditorID?before=edit">
         <menu
               label="%menu.label">
            <command
                  commandId="org.eclipse.emf.facet.efacet.ui.createFacetInFacetSet"
                  icon="icons/facet.gif"
                  style="push">
               <visibleWhen
                     checkEnabled="true">
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.emf.facet.efacet.ui.addParameterToFacetOperation"
                  icon="icons/facet.gif"
                  style="push">
               <visibleWhen
                     checkEnabled="true">
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.emf.facet.efacet.ui.addFacetReference"
                  icon="icons/facet.gif"
                  style="push">
               <visibleWhen
                     checkEnabled="true">
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.emf.facet.efacet.ui.addFacetOperation"
                  icon="icons/facet.gif"
                  style="push">
               <visibleWhen
                     checkEnabled="true">
               </visibleWhen>
            </command>
            <command
                  commandId="org.eclipse.emf.facet.efacet.ui.addFacetAttribute"
                  icon="icons/facet.gif"
                  style="push">
               <visibleWhen
                     checkEnabled="true">
               </visibleWhen>
            </command>
         </menu>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <category
            id="org.eclipse.emf.facet.widgets.table.command.category"
            name="%category.name">
      </category>
      <command
            id="org.eclipse.emf.facet.efacet.ui.createFacetInFacetSet"
            name="%command.name">
      </command>
      <command
            id="org.eclipse.emf.facet.efacet.ui.addFacetAttribute"
            name="%command.name.0">
      </command>
      <command
            id="org.eclipse.emf.facet.efacet.ui.addFacetOperation"
            name="%command.name.1">
      </command>
      <command
            id="org.eclipse.emf.facet.efacet.ui.addParameterToFacetOperation"
            name="%command.name.2">
      </command>
      <command
            id="org.eclipse.emf.facet.efacet.ui.addFacetReference"
            name="%command.name.3">
      </command>
      <command
            defaultHandler="org.eclipse.modisco.facet.efacet.ui.internal.handlers.NavigationHandler"
            id="org.eclipse.emf.facet.efacet.ui.navigate"
            name="%navigate_handler">
      </command>
      <command
            categoryId="org.eclipse.emf.facet.widgets.table.command.category"
            id="org.eclipse.emf.facet.efacet.ui.loadFacet"
            name="%loadFacets">
      </command>
      <command
            categoryId="org.eclipse.emf.facet.widgets.table.command.category"
            defaultHandler="org.eclipse.modisco.facet.efacet.ui.internal.handlers.SaveStructuralFeatureInstanceModelHandler"
            id="org.eclipse.emf.facet.efacet.ui.saveStructuralFeatureInstanceModel"
            name="%SaveStructuralFeatureInstanceModel">
      </command>
      <command
            categoryId="org.eclipse.emf.facet.widgets.table.command.category"
            defaultHandler="org.eclipse.modisco.facet.efacet.ui.internal.handlers.SetStructuralFeatureInstanceResourceHandler"
            id="org.eclipse.emf.facet.efacet.ui.setStructuralFeatureInstanceResource"
            name="%SetSFInstanceResource">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="org.eclipse.modisco.facet.efacet.ui.internal.handlers.CreateFacetInFacetSetHandler"
            commandId="org.eclipse.emf.facet.efacet.ui.createFacetInFacetSet">
         <activeWhen>
            <with
                  variable="selection">
               <test
                     forcePluginActivation="true"
                     property="org.eclipse.emf.facet.efacet.ui.facetPropertyTester.isFacetSet"
                     value="true">
               </test>
            </with>
         </activeWhen>
      </handler>
      <handler
            class="org.eclipse.modisco.facet.efacet.ui.internal.handlers.AddFacetOperationHandler"
            commandId="org.eclipse.emf.facet.efacet.ui.addFacetOperation">
         <activeWhen>
            <with
                  variable="selection">
               <test
                     forcePluginActivation="true"
                     property="org.eclipse.emf.facet.efacet.ui.facetPropertyTester.isFacet"
                     value="true">
               </test>
            </with>
         </activeWhen>
      </handler>
      <handler
            class="org.eclipse.modisco.facet.efacet.ui.internal.handlers.AddFacetAttributeHandler"
            commandId="org.eclipse.emf.facet.efacet.ui.addFacetAttribute">
         <activeWhen>
            <with
                  variable="selection">
               <test
                     forcePluginActivation="true"
                     property="org.eclipse.emf.facet.efacet.ui.facetPropertyTester.isFacet"
                     value="true">
               </test>
            </with>
         </activeWhen>
      </handler>
      <handler
            class="org.eclipse.modisco.facet.efacet.ui.internal.handlers.AddFacetParameterOperationHandler"
            commandId="org.eclipse.emf.facet.efacet.ui.addParameterToFacetOperation">
         <activeWhen>
            <with
                  variable="selection">
               <test
                     forcePluginActivation="true"
                     property="org.eclipse.emf.facet.efacet.ui.facetPropertyTester.isFacetOperation"
                     value="true">
               </test>
            </with>
         </activeWhen>
      </handler>
      <handler
            class="org.eclipse.modisco.facet.efacet.ui.internal.handlers.AddFacetReferenceHandler"
            commandId="org.eclipse.emf.facet.efacet.ui.addFacetReference">
         <activeWhen>
            <with
                  variable="selection">
               <test
                     forcePluginActivation="true"
                     property="org.eclipse.emf.facet.efacet.ui.facetPropertyTester.isFacet"
                     value="true">
               </test>
            </with>
         </activeWhen>
      </handler>
      <handler
            class="org.eclipse.modisco.facet.efacet.ui.internal.handlers.LoadFacetHandler"
            commandId="org.eclipse.emf.facet.efacet.ui.loadFacet">
         <enabledWhen>
            <with
                  variable="activePart">
               <adapt
                     type="org.eclipse.emf.facet.efacet.core.IFacetManagerProvider">
               </adapt>
            </with>
         </enabledWhen>
      </handler>
   </extension>
   <extension
         point="org.eclipse.core.expressions.propertyTesters">
      <propertyTester
            class="org.eclipse.modisco.facet.efacet.ui.internal.handlers.FacetPropertyTester"
            id="org.eclipse.emf.facet.efacet.ui.facetPropertyTester"
            namespace="org.eclipse.emf.facet.efacet.ui.facetPropertyTester"
            properties="isFacet,isFacetSet,isFacetOperation,isFacetAttribute,isFacetReference"
            type="org.eclipse.jface.viewers.StructuredSelection">
      </propertyTester>
   </extension>
   <extension
         point="org.eclipse.ui.views">
      <view
            category="org.eclipse.emf.facet.common.ui.views"
            class="org.eclipse.modisco.facet.efacet.ui.internal.view.NavigationView"
            id="org.eclipse.emf.facet.efacet.ui.view.navigation"
            name="%navigation_view"
            restorable="true">
      </view>
   </extension>

   <extension point="org.eclipse.ui.views">
      <view
            category="org.eclipse.emf.facet.common.ui.views"
            class="org.eclipse.modisco.facet.efacet.ui.internal.view.FacetSetsCatalogView"
            icon="icons/facet.gif"
            id="org.eclipse.emf.facet.efacet.ui.view.catalog"
            name="%view.facetSets"
            restorable="true">
      </view>
   </extension>
   
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="true"
            locationURI="popup:org.eclipse.ui.popup.any?after=additions">
         <command
               commandId="org.eclipse.emf.facet.efacet.ui.navigate"
               label="%navigate_command"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <with
                     variable="selection">
                  <iterate
                        ifEmpty="false">
                     <instanceof
                           value="org.eclipse.emf.ecore.EObject">
                     </instanceof>
                  </iterate>
               </with>
            </visibleWhen>
         </command>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.core.runtime.preferences">
      <initializer
            class="org.eclipse.modisco.facet.efacet.ui.internal.preferences.PreferencesInitializer">
      </initializer>
   </extension>
</plugin>
